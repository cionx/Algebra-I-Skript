\chapter{Invariants for matrix actions and Zariski dense sets}





\section{Invariants for matrix actions}
For this section we require all fields to be infinite.


\begin{thrm}
 Let $\SL_n(k)$ act on $\Mat_n(k)$ by left multiplication. Then
 \[
  \det \colon \Mat_n(k) \to k
 \]
 generates $\mc{P}(M_n(k))^{\SL_n(k)}$ as a $k$-algebra and is algebraically independent, i.e.
 \[
  \mc{P}(M_n(k))^{\SL_n(k)} \cong k[X] \text{ via } \det \mapsfrom X.
 \]
\end{thrm}
\begin{proof}
 We choose the basis $E_{ij}, 1 \leq i,j \leq n$ of $M_n(k)$ where the $E_{ij}$ is the matrix with $1$ as the entry in the $i$-th row and $j$-th colomn and $0$ otherwise. (So $E_{ij} e_k = \delta_{jk}e_i$ where $e_1$, \dots, $e_n$ is the standard basis of $k^n$.)  For a matrix $A = (a_{ij})_{1 \leq i,j \leq n}$ we then have
 \[
  \det A
  = \det\left( a_{ij} E_{ij}\right)
  = \sum_{\sigma \in S_n} \sgn(\sigma) a_{1 \sigma(1)} \dotsm a_{n \sigma(n)}.
 \]
 So $\det \in \mc{P}(\Mat_n(k))$. Since for every $S \in \SL_n(k)$ and $A \in \Mat_n(k)$
 \[
  (S.\det)(A) = \det\left(S^{-1}.A\right) = \det\left(S^{-1}\right) \det(A) = \det(A)
 \]
 we also find that $\det$ is $\SL_n(k)$-invariant. So $\det \in \mc{P}(\Mat_n(k))^{\SL_n(k)}$.
 
 Next we show that $\det$ is algebraically independent. Let $P \in k[X]$ with $P(\det) = 0$. Then we have
 \[
  P(\det(A)) = P(\det)(A) = 0
 \]
 for all $A \in \Mat_n(k)$. Since $\det$ is surjective this means that $P(\lambda) = 0$ for all $\lambda \in k$. Because $k$ is infinite this means that $P$ has infinitely many zeroes. Therefore $P = 0$.
 
 All that’s left to show is that $\det$ generates $\mc{P}(\Mat_n(k))^{\SL_n(k)}$ as a $k$-algebra. For this fix $f \in \mc{P}(\Mat_n(k))^{\SL_n(k)}$. Since $f$ is a polynomial map there exists $p \in k[X_{11}, \dotsc, X_{nn}]$ such that
 \[
  f(A) = p(a_{11}, \dotsc, a_{nn})
 \]
 for all $A = (a_{ij})_{1 \leq i,j \leq n} \in \Mat_n(k)$. We define $\bar{p} \in k[t]$ as $\varphi(p)$, where
 \[
  \varphi \colon k[X_{11}, \dotsc, X_{nn}] \to k[t]
 \] 
 is the algebra homomorphism defined by 
 \[
  \varphi(X_{ij}) =
  \begin{cases}
   0 & \text{ if } i \neq j, \\
   1 & \text{ if } i = j \neq 1, \\
   t & \text{ if } i = j = 1.
  \end{cases}
 \]
 It is clear that
 \[
  \bar{p}(\lambda) \coloneqq
  f\left(
   \begin{pmatrix}
    \lambda &   &        &   \\
            & 1 &        &   \\
            &   & \ddots &   \\
            &   &        & 1 \\
   \end{pmatrix}
  \right)
 \]
 for all $\lambda \in k$.
 
 Now let $A \in \GL_n(k)$. Since $\det A \neq 0$ we have
 \[
  B \coloneqq
  \begin{pmatrix}
   \det A &   &        &   \\
          & 1 &        &   \\
          &   & \ddots &   \\
          &   &        & 1 \\
  \end{pmatrix}
  \in \GL_n(k).
 \]
 Since $\det A = \det B$ we also have $S \coloneqq AB^{-1} \in \SL_n(k)$. Combining this we find that
 \[
  f(A) = f(SB) = \left(S^{-1}.f\right)(B) = f(B) = \bar{p}(\det A) = \bar{p}(\det)(A).
 \]
 Therefore we have $f - \bar{p}(\det) = 0$ when restricted to $\GL_n(k)$, where it is clear that $\bar{p}(\det) \in \mc{P}(\Mat_n(k))^{\SL_n}$.
 
 \begin{claim}[Zariski density property 1]
  Let $h \in \mc{P}(\Mat_n(k))$ such that $h_{|\GL_n(k)} = 0$. Then $h = 0$.
 \end{claim}
 
 From this claim and the previous observations it follows that $f - \bar{p}(\det) = 0$ and thus $f = \bar{p}(\det) \in k[\det]$. This shows that $\det$ generates $\mc{P}(\Mat_n(k))^{\SL_n(k)}$ as a $k$-algebra. (We will prove the claim later and end this proof here.)
\end{proof}


Recall from linear algebra that the characteristic polynomial of a matrix $A \in \Mat_n(k)$ is defined as
\[
 \chi_A(t) = \det(t E_n - A)
\]
where $E_n \in \Mat_n(k)$ is the identity matrix, and that this results in
\[
 \chi_A(t) = t^n - s_1(A) t^{n-1} + s_2(A) t^{n-2} + \dotsb + (-1)^n s_n(A)
\]
where $s_1, \dotsc, s_n \in \mc{P}(\Mat_n(k))$. In particular $s_1 = \tr$ and $s_n = \det$.

In the case that $A$ is a diagonal matrix $A = \diag(d_1, \dotsc, d_n)$ we have
\[
 \chi_A(t)
 = \prod_{i=1}^n (t-d_i)
 = t^n - e_1(d_1, \dotsc, d_n) t^{n-1} + \dotsb + (-1)^n e_n(d_1, \dotsc, d_n).
\]
Therefore
\[
 s_i(\diag(d_1, \dotsc, d_n)) = e_i(\diag(d_1, \dotsc, d_n))
\]
for all $1 \leq i \leq n$ and every diagonal matrix $\diag(d_1, \dotsc, d_n)$.


\begin{thrm}
 Let $\GL_n(k)$ act on $\Mat_n(k)$ by conjugation, i.e.
 \[
  S.A = SAS^{-1}
 \]
 for all $A \in \Mat_n(k)$ and $S \in \GL_n(k)$. Then $s_1$, \dots, $s_n$ generate $\mc{P}(\Mat_n(k))^{\GL_n(k)}$ as a $k$-algebra and are algebraically independent. Therefore
 \[
  \mc{P}(\Mat_n(k))^{\GL_n(k)} \cong k[X_1, \dotsc, X_n] \text{ via } s_i \mapsfrom X_i.
 \]
\end{thrm}
\begin{proof}
 We already know that $s_1, \dotsc, s_n \in \mc{P}(\Mat_n(k))$. That $s_1$, \dots, $s_n$ are $\GL_n(k)$-invariant directly follows from the fact that the characteristic polynomial of a matrix is invariant under conjugation.
 
 Next we show that $s_1$, \dots, $s_n$ are algebraically independent. For this let $p \in k[X_1, \dotsc, X_n]$ with $p(s_1, \dotsc, s_n) = 0$. This means that
 \[
  p(s_1, \dotsc, s_n)(A) = 0 \text{ for all } A \in \Mat_n(k).
 \]
 For
 \[
  D \coloneqq \{\diag(d_1, \dotsc, d_n) \mid d_1, \dotsc, d_n \in k\}
 \]
 we therefore have
 \[
  p(s_1, \dotsc, s_n)(A) = 0 \text{ for all } A \in D.
 \]
 By the observations above this means that 
 \[
  p(e_1, \dotsc, e_n)(d_1, \dotsc, d_n) = 0 \text{ for all } d_1, \dotsc, d_n \in k.
 \]
 Because $k$ is infinite this mean that $p(e_1, \dotsc, e_n) = 0$. Since $e_1$, \dots, $e_n$ are algebraically independent we find that $p =0$.
 
 All that’s left to show is that $s_1$, \dots, $s_n$ generate $\mc{P}(\Mat_n(k))^{\GL_n(k)}$ as a $k$-algebra. For this let $f \in \mc{P}(\Mat_n(k))^{\GL_n(k)}$. Because $f$ is a polynomial map there exists $p \in k[X_{11}, \dotsc, X_{nn}]$ such that
 \[
  f(A) = p(a_{11}, \dotsc, a_{nn}) \text{ for all } A = (a_{ij})_{1 \leq i,j \leq n} \in \Mat_n(k).
 \]
 We define $\bar{p} \in k[t_1, \dotsc, t_n]$ as $\bar{p} \coloneqq \varphi(p)$ where
 \[
  \varphi \colon k[X_{11}, \dotsc, X_{nn}] \to k[t_1, \dotsc, t_n]
 \]
 is the algebra homomorphism defined by
 \[
  \varphi(X_{ij}) =
  \begin{cases}
   t_i & \text{if } i = j, \\
     0 & \text{otherwise}.
  \end{cases}
 \]
 By definition of $\bar{p}$ we have
 \[
  f(\diag(d_1, \dotsc, d_n)) = \bar{p}(d_1, \dotsc, d_n) \text{ for all } d_1, \dotsc, d_n \in k.
 \]
 
 We claim that $\bar{p}$ is symmetric, i.e.\ $\bar{p} \in k[t_1, \dotsc, t_n]^{S_n}$. Since $k$ is infinite we have the usual $S_n$-equivariant algebra isomorphism
 \[
 \Phi \colon k[t_1, \dotsc, t_n] \to \mc{P}(k^n).
 \]
 Thus it is enough to show that the corresponding polynomial function $\Phi(\bar{p})$ is $S_n$-invariant. This follows from the fact that $f$ is $\GL_n(k)$-invariant: For all $\pi \in S_n$ we define the corresponding permutation matrix $A_\pi \in \GL_n(k)$ via
 \[
  A_\pi e_i = e_{\pi(i)}.
 \]
 For all $\pi \in S_n$ and $d_1, \dotsc, d_n \in k$ we then have
 \[
  A_\pi \diag(d_1, \dotsc, d_n) A_\pi^{-1}
  = \diag\left(d_{\pi^{-1}(1)}, \dotsc, d_{\pi^{-1}(n)}\right).
 \]
 Therefore we have for all $\pi \in S_n$ and $(d_1, \dotsc, d_n) \in k^n$
 \begin{align*}
  &\,(\pi.\Phi(\bar{p}))((d_1, \dotsc, d_n)) \\
  =&\, \Phi(\bar{p})\left(\pi^{-1}.(d_1, \dotsc, d_n)\right)
  = \Phi(\bar{p})\left(\left(d_{\pi(1)}, \dotsc, d_{\pi(n)}\right)\right) \\
  =&\, \bar{p}\left(d_{\pi(1)}, \dotsc, d_{\pi(n)}\right)
  = f\left(\diag\left(d_{\pi(1)}, \dotsc, d_{\pi(n)}\right)\right) \\
  =&\, f\left(A_{\pi^{-1}} \diag(d_1, \dotsc, d_n) A_\pi\right)
  = f\left(A_\pi^{-1} \diag(d_1, \dotsc, d_n) A_\pi\right) \\
  =&\, f\left(A_\pi^{-1}.\diag(d_1, \dotsc, d_n)\right)
  = (A_\pi.f)(\diag(d_1, \dotsc, d_n)) \\
  =&\, f(\diag(d_1, \dotsc, d_n))
  = \bar{p}(d_1, \dotsc, d_n) \\
  =&\, \Phi(\bar{p})((d_1, \dotsc, d_n)).
 \end{align*}
 This shows that $\Phi(\bar{p})$ is $S_n$-equivariant. So $\bar{p}$ is symmetric.
 
 Since $e_1$, \dots, $e_n$ generate $k[t_1, \dotsc, t_n]^{S_n}$ there exists $q \in k[X_1, \dotsc, X_n]$ such that
 \[
  \bar{p} = q(e_1, \dotsc, e_n),
 \]
 therefore
 \begin{align*}
  f(\diag(d_1, \dotsc, d_n))
  &= q(e_1, \dotsc, e_n)(d_1, \dotsc, d_n) \\
  &= q(s_1, \dotsc, s_n)(\diag(d_1, \dotsc, d_n))
 \end{align*}
 for all $d_1, \dotsc, d_n \in k$. This show that $f-q(s_1, \dotsc, s_n) = 0$ when restricted to $D$.
 
 \begin{claim}[Zariski density property 2]
  If $h \in \mc{P}(\Mat_n(k))^{\GL_n(k)}$ (where $\GL_n(k)$ acts on $\Mat_n(k)$ by conjugation) and $h_{|D} = 0$ then $h = 0$.
 \end{claim}

 From this claim and the results so far we find that $f - q(s_1, \dotsc, s_n) = 0$ and thus $f = q(s_1, \dotsc, s_n)$. (As before we will leave the proof of the claim for later and end this proof here.)
\end{proof}


Another ``famous'' family of polynomial functions in $\mc{P}(\Mat_n(k))^{\GL_n(k)}$ (where $\GL_n(k)$ acts on $\Mat_n(k)$ by conjugation) are the so called power traces. The $m$-th power trace is defined as
\[
 \tr_m \colon \Mat_n(k) \to k, A \mapsto \tr A^m.
\]
for all $m \geq 0$. It is clear that $\tr_m \in \mc{P}(\Mat_n(k))^{\GL_n(k)}$ for all $m \geq 0$ and that $\tr_m$ is $\GL_n(k)$-invariant follows from the fact that for all $S \in \GL_n(k)$ and $A \in \Mat_n(k)$
\begin{align*}
 \left(S.\tr_m\right)(A)
 &= \tr_m\left(S^{-1}.A\right)
 = \tr_m\left(S^{-1} A S\right) \\
 &= \tr \left(S^{-1} A S\right)^m
 = \tr \left(S^{-1} A^m S\right) \\
 &= \tr A^m
 = \tr_m(A).
\end{align*}


\begin{thrm}
 Let $n \geq 1$ and let $k$ be an infinite field with either $\kchar k = 0$ or $\kchar k > n$. Let $\GL_n(k)$ act on $\Mat_n(k)$ by conjugation. Then $\tr_1$, \dots, $\tr_n$ generate $\mc{P}(\Mat_n(k))^{\GL_n(k)}$ as a $k$-algebra and are algebraically independent, i.e.
 \[
  \mc{P}(\Mat_n(k))^{\GL_n(k)} \cong k[X_1, \dotsc, X_n] \text{ via } \tr_i \mapsfrom X_i.
 \]
\end{thrm}
\begin{proof}
 As before let 
 \[
  D \coloneqq \{\diag(d_1, \dotsc, d_n) \mid d_1, \dotsc, d_n \in k\}.
 \]
 For every diagonal matrix $\diag(d_1, \dotsc, d_n) \in D$ we have
 \[
  \tr_m(\diag(d_1, \dotsc, d_n)) = d_1^m + \dotsb + d_n^m = p^{(n)}_m(d_1, \dotsc, d_n)
 \]
 for all $m \geq 0$. Since $k$ is a field with $\kchar k = 0$ or $\kchar k > n$ we know that $p^{(n)}_1$, \dots, $p^{(n)}_n$ generate $k[X_1, \dotsc, X_n]^{S_n}$ as a $k$-algebra and are algebraically independent.
 
 Using these observations we can now prove the theorem by simpley copying the proof of the previous theorem and replacing $s_i$ with $\tr_i$ and $e_i$ with $p_i$.
\end{proof}





\section{Zariski dense subsets}
In this section let $k$ be an infinite field.


\begin{defi}
 Let $W$ be a finite-dimensional $k$-vector space. A subset $X \subseteq W$ is called Zariski dense (over $k$) if for any $f \in \mc{P}_k(W)$ we have
 \[
  f_{|X} = 0 \Rightarrow f = 0.
 \]
 If $X \subseteq Y \subseteq W$ then $X$ is Zariski dense in $Y$ (over $k$) if for all $f \in \mc{P}_k(W)$
 \[
  f_{|X} = 0 \Rightarrow f_{|Y} = 0.
 \]
\end{defi}


\begin{expls}\leavevmode
 \begin{enumerate}[a)]
  \item 
  Let $X \subseteq k$ an infinite subset. Then $X$ is Zariski dense: Let $f \in \mc{P}(k)$ with $f_{|X} = 0$. Since $f$ is a polynomial function there exists $p \in k[X]$ with $f(\lambda) = p(\lambda)$ for all $\lambda \in k$. Since $f_{|X} = 0$ and $X$ is infinite the polynomial $p$ has infinitely many zeroes. Therefore $p = 0$ and $f = 0$.
  \item
  Let $W$ be a finite-dimensional $k$-vector space and $U \subsetneq W$ a vector subspace. Then $U$ is not Zariski dense in $W$ over $k$: To see this let $w_1$, \dots, $w_n$, $w_{n+1}$, \dots, $w_m$ be a $k$-basis of $W$ such that $w_1$, \dots, $w_n$ is a $k$-basis of $U$. Since $U \neq W$ we have $n < m$. We define $\pi \in \mc{P}_k(W)$ as the projection
  \[
   \pi\left(\sum_{i=1}^m \lambda_i w_i\right) = \lambda_m.
  \]
  We have $\pi_{|U} = 0$ but $\pi \neq 0$, so $U$ is not Zariski dense in $W$ over $k$.
 \end{enumerate}
\end{expls}


\begin{warn}
 The notion of Zariski density depends on the underlying field. From the previous examples it follows that $\R \subseteq \C$ is Zariski dense over $\C$, but not over $\R$.
\end{warn}



\begin{lem}
 $k^n \subseteq L^n$ is Zariski dense over $L$.
\end{lem}
\begin{proof}
 We show the statement by induction over $n$.
 
 ($n = 1$) For $f \in \mc{P}(L)$ with $f_{|k} = 0$ the corresponding polynomial $p \in L[X]$ (i.e.\ $f(\lambda) = p(\lambda)$ for all $\lambda \in L$) has infintely many zeroes. So $p = 0$ and therefore $f = 0$.
 
 ($n \geq 2$) Suppose the statement holds for $n-1$. Let $f \in \mc{P}\left(L^n\right)$ with $f_{|k^n} = 0$. Because $f$ is a polynomial function there exists $p \in L[X_1, \dotsc, X_n]$ with $f((\lambda_1, \dotsc, \lambda_n)) = p(\lambda_1, \dotsc, \lambda_n)$ for all $(\lambda_1, \dotsc, \lambda_n) \in L^n$. We can write $p$ as
 \[
  p(X_1, \dotsc, X_n) = \sum_{i \in \N} p_i(X_1, \dotsc, X_{n-1}) X_n^i
 \]
 with $p_i \in L[X_1, \dotsc, X_{n-1}]$ for all $i \in \N$ and $p_i \neq 0$ for only finitely many $i \in \N$. Let $(\lambda_1, \dotsc, \lambda_{n-1}) \in k^{n-1}$ be fixed but arbitrary and $\bar{p} \in L[X_n]$ be defined as
 \[
  \bar{p}(X_n) \coloneqq p(\lambda_1, \dotsc, \lambda_{n-1}, X_n) = \sum_{i \in \N} p_i(\lambda_1, \dotsc, \lambda_{n-1}) X_n^i.
 \]
 Since $\bar{p}(\lambda_n) = 0$ for all $\lambda_n \in k$ we find that $\bar{p} = 0$ (since $\bar{p}$ has infinitely many zeroes). Because $L$ is infinite this means that $p_i(\lambda_1, \dotsc, \lambda_{n-1}) = 0$ for all $i \in \N$. Since $(\lambda_1, \dotsc, \lambda_{n-1}) \in k^{n-1}$ is arbitrary we find that $p_i(\lambda_1, \dotsc, \lambda_{n-1}) = 0$ for all $\lambda_1, \dotsc, \lambda_{n-1} \in k$ for every $i \in \N$. By using the induction hypothesis we find that $p_i(\lambda_1, \dotsc, \lambda_{n-1}) = 0$ for all $i \in \N$ and $\lambda_1, \dotsc, \lambda_{n-1} \in L$. Because $L$ is infinite it follows that $p_i = 0$ for all $i \in \N$. Therefore $p = 0$ and $f = 0$.
\end{proof}


We can generalize this obeservation in the language of extension of scalars:


\begin{lem}\label{lem: W Zariski dense in W_L}
 Let $W$ be a finite-dimensional $k$-vector space. Then $W$ is Zariski dense in $W_L$ over $L$.
\end{lem}
\begin{proof}
 Let $w_1$, \dots, $w_n$ be a $k$-basis of $W$. Then $1 \otimes w_1$, \dots, $1 \otimes w_n$ is an $L$-basis of $W_L$. Using this bases we have an isomorphism of $k$-vector spaces
 \[
  \phi \colon k^n \to W, e_i \mapsto w_i
 \]
 and an isomorphism of $L$-vector spaces
 \[
  \psi \colon L^n \to W_L, e_i \mapsto 1 \otimes w_i
 \]
 and the following commutative diagram.
 \begin{center}
  \tikzsetnextfilename{W_Zariski_dense_in_WL}
  \begin{tikzpicture}[node distance = 6em]
   \node (W) {$W$};
   \node (WL) [below of = W] {$W_L$};
   \node (kn) [right of = W] {$k^n$};
   \node (Ln) [below of = kn] {$L^n$};
   \draw[double equal sign distance] (W) to node[above] {$\sim$} (kn);
   \draw[double equal sign distance] (WL) to node[above] {$\sim$} (Ln);
   \draw[right hook ->] (W) to (WL);
   \draw[right hook ->] (kn) to (Ln);
  \end{tikzpicture}
 \end{center}
 The isomorphism $\psi$ of $L$-vector spaces induces the isomorphism
 \[
  \psi^* \colon \mc{P}_L(W_L) \to \mc{P}_L(L^n), h \mapsto h \circ \psi
 \]
 of $L$-algebras. For $f \in \mc{P}_L(W_L)$ with $f_{|W} = 0$ we have $g \coloneqq \psi^*(f) \in \mc{P}_L(L^n)$ with $g_{|k^n} = 0$. Since $k^n$ is Zariski dense in $L^n$ over $L$ we find that $g = 0$. Since $\psi^*$ is an isomorphism of $L$-algebras it follows that $f = 0$.
\end{proof}


As we have seen in the last chapter we have $\mc{P}_k(W)_L \cong \mc{P}_L(W_L)$ as $L$-algebras. The problem of the constructed isomorphism is that it depends on choosing a $k$-basis of $W$ and an $L$-basis of $W_L$. We will now construct an isomorphism which does not depend on such choice.


\begin{lem}
 Let $W$ be a finite-dimensional $k$-vector space. Then there exists an unique map
 \[
  \iota \colon \mc{P}_k(W) \to \mc{P}_L(W_L)
 \]
 such that for every $f \in \mc{P}_k(W)$ the diagram
 \begin{center}
  \tikzsetnextfilename{inclusion_of_algebras_of_polynomial_functions_1}
  \begin{tikzpicture}[node distance = 6em]
   \node (W) {$W$};
   \node (WL) [right of = W] {$W_L$};
   \node (k) [below of = W] {$k$};
   \node (L) [below of = WL] {$L$};
   \draw[right hook ->] (W) to node[above] {$\can_W$} (WL);
   \draw[right hook ->] (k) to (L);
   \draw[->] (W) to node[left] {$f$} (k);
   \draw[->] (WL) to node[right] {$\iota(f)$} (L);
  \end{tikzpicture}
 \end{center}
 commutes and this map is a monomorphism of $k$-algebras.
\end{lem}
\begin{proof}
 Let $w_1$, \dots, $w_n$ be a $k$-basis of $W$. Using this basis we get an isomorphism of $k$-algebras
 \begin{align*}
  \Phi \colon k[X_1, \dotsc, X_n] &\to \mc{P}_k(W), \\
  f &\mapsto \left( \sum_{i=1}^n \mu_i w_i \mapsto f(\mu_1, \dotsc, \mu_n) \right).
 \end{align*}
 Using the corresponding $L$-basis $1 \otimes w_1$, \dots, $1 \otimes w_n$ of $W$ we also have an isomorphism of $L$-algebras
 \begin{align*}
  \Psi \colon L[X_1, \dotsc, X_n] &\to \mc{P}_L(W_L), \\
  f &\mapsto \left( \sum_{i=1}^n \lambda_i (1 \otimes w_i) \mapsto f(\lambda_1, \dotsc, \lambda_n) \right).
 \end{align*}
 Together with the canonical inclusion
 \[
  j \colon k[X_1, \dotsc, X_n] \hookrightarrow L[X_1, \dotsc, X_n]
 \]
 we set
 \[
  \iota \coloneqq \Psi \circ j \circ \Phi^{-1},
 \]
 i.e.\ we make the diagram
 \begin{center}
  \tikzsetnextfilename{inclusion_of_algebras_of_polynomial_functions_2}
  \begin{tikzpicture}[node distance = 6em]
   \node (Pk) {$\mc{P}_k(W)$};
   \node (PL) [right = 6em of Pk] {$\mc{P}_L(W_L)$};
   \node (kX) [below of = Pk] {$k[X_1, \dotsc, X_n]$};
   \node (LX) [below of = PL] {$L[X_1, \dotsc, X_n]$};
   \draw[right hook ->] (Pk) to node[above] {$\iota$} (PL);
   \draw[right hook ->] (kX) to (LX);
   \draw[double equal sign distance] (kX) to node[right] {$\wr$} (Pk);
   \draw[double equal sign distance] (LX) to node[right] {$\wr$} (PL);
  \end{tikzpicture}
 \end{center}
 commute. To show that $\iota$ has the described property we notice that
 \[
  \iota \colon
  \left( \sum_{i=1}^n \mu_i w_i \mapsto f(\mu_1, \dotsc, \mu_n) \right)
  \mapsto
  \left( \sum_{i=1}^n \lambda_i (1 \otimes w_i) \mapsto f(\lambda_1, \dotsc, \lambda_n) \right)
 \]
 and therefore for every $f \in \mc{P}_k(W)$ for all $v = \sum_{i=1}^n \mu_i w_i \in W$
 \begin{align*}
  \left( \iota(f) \circ \can_V \right)(v)
  &= \iota(f)\left( \can_V\left( \sum_{i=1}^n \mu_i w_i \right) \right) \\
  &= \iota(f)\left( \sum_{i=1}^n \mu_i (1 \otimes w_i) \right)
  = f(\mu_1, \dotsc, \mu_n).
 \end{align*}
 
 All that’s left to show is the uniqueness of $\iota$. For this we will use our newly acquired wisdom about Zariski density. Suppose we have a map
 \[
  i \colon \mc{P}_k(W) \to \mc{P}_L(W_L)
 \]
 such that the diagram
  \begin{center}
  \tikzsetnextfilename{inclusion_of_algebras_of_polynomial_functions_3}
  \begin{tikzpicture}[node distance = 6em]
   \node (W) {$W$};
   \node (WL) [right of = W] {$W_L$};
   \node (k) [below of = W] {$k$};
   \node (L) [below of = WL] {$L$};
   \draw[right hook ->] (W) to node[above] {$\can_W$} (WL);
   \draw[right hook ->] (k) to (L);
   \draw[->] (W) to node[left] {$f$} (k);
   \draw[->] (WL) to node[right] {$i(f)$} (L);
  \end{tikzpicture}
 \end{center}
 commutes for all $f \in \mc{P}_k(W)$. For every polynomial map $f \in \mc{P}_k(W)$ we then have \mbox{$\iota(f)-i(f) \in \mc{P}_L(W_L)$} with
 \[
  \left( \iota(f)-i(f) \right)_{|W} = 0.
 \]
 Since $W$ is Zariski dense in $W_L$ over $L$ it follows that $\iota(f) - i(f) = 0$ and therefore $\iota(f) = i(f)$.
\end{proof}


Using this inclusion we now get an isomorphism of $L$-algebras $\mc{P}_k(W)_L \cong \mc{P}_L(W_L)$ for free.


\begin{prop}
 Let $k$ be a finite-dimensional $k$-vector space. Then the map
 \[
  \Phi \colon \mc{P}_k(W)_L \to \mc{P}_L(W_L), \lambda \otimes f \mapsto \lambda \iota(f)
 \]
 is an isomorphism of $L$-algebras, where $\iota \colon \mc{P}_k(W) \to \mc{P}_L(W_L)$ is the inclusion as before.
\end{prop}
\begin{proof}
 Let $v_1$, \dots, $v_n$ be a $k$-basis of $W$ and $\varphi_1, \dotsc, \varphi_n \in \mc{P}_k(W)$ the corresponding coordinate functions. Then $\varphi^\alpha = \varphi_1^{\alpha_1} \dotsm \varphi_n^{\alpha_n}$ with $\alpha \in \N^n$ are a $k$-basis of $\mc{P}_k(W)$ and an $L$-basis of $\mc{P}_L(W_L)$ (where we identify $W$ with the corresponding $k$-vector subspace of $W_L$ and $\mc{P}_k(W)$ with the corresponding $k$-subalgebra of $\mc{P}_L(W_L)$ under $\iota$). Therefore the statement follows from Corollary \ref{cor: inclusion to bijection algebras} in the appendix about extension of scalars.
\end{proof}


We can also combine all these commuting diagrams into a big one: Given a $k$-vector space $W$ and a $k$-basis $w_1$, \dots, $w_n$ of $W$ we have an isomorphism
\[
 k[X_1, \dotsc, X_n] \cong \mc{P}_k(W)
\]
of $k$-vector spaces, and corresponding with the $L$-basis $1 \otimes w_1$, \dots, $1 \otimes w_n$ of $W_L$ we have an isomorphism of $L$-algebras
\[
 L[X_1, \dotsc, X_n] \cong \mc{P}_L(W_L).
\]
This gives us the following commutative diagram.
\begin{center}
 \tikzsetnextfilename{commuting_prism_backside}
 \begin{tikzpicture}[node distance = 6em]
  \node (Pk) {$\mc{P}_k(W)$};
  \node (PL) [right = 6em of Pk] {$\mc{P}_L(W_L)$};
  \node (kX) [below of = Pk] {$k[X_1, \dotsc, X_n]$};
  \node (LX) [below of = PL] {$L[X_1, \dotsc, X_n]$};
  \draw[right hook ->] (Pk) to node[above] {$\iota$} (PL);
  \draw[right hook ->] (kX) to (LX);
  \draw[double equal sign distance] (kX) to node[right] {$\wr$} (Pk);
  \draw[double equal sign distance] (LX) to node[right] {$\wr$} (PL);
 \end{tikzpicture}
\end{center}
Given the inclusion $\iota \colon \mc{P}_k(W) \to \mc{P}_L(W_L)$ and the corresponding isomorphism of $L$-algebras $\mc{P}_k(W)_L \cong \mc{P}_L(W_L)$ we also have the following commutative diagram.
\begin{center}
 \tikzsetnextfilename{commuting_prism_top}
 \begin{tikzpicture}[node distance = 6em]
  \node (Pk) {$\mc{P}_k(W)$};
  \node (PL) [right = 6em of Pk] {$\mc{P}_L(W_L)$};
  \node (PkL) [below of = Pk] {$\mc{P}_k(W)_L$};
  \draw[right hook ->] (Pk) to node[left] {$\iota$} (PkL);
  \draw[right hook ->] (Pk) to (PL);
  \draw[double equal sign distance] (PkL) to node[above,rotate=30] {$\sim$} (PL);
 \end{tikzpicture}
\end{center}
We get a similar diagram for polynomial rings. (See the appendix about extension of scalars for more details.)
\begin{center}
 \tikzsetnextfilename{commuting_prism_bottom}
 \begin{tikzpicture}[node distance = 6em]
  \node (kX) {$k[X_1, \dotsc, X_n]$};
  \node (LX) [right = 6em of kX] {$L[X_1, \dotsc, X_n]$};
  \node (kXL) [below of = kX] {$k[X_1, \dotsc, X_n]_L$};
  \draw[right hook ->] (kX) to (LX);
  \draw[right hook ->] (kX) to (kXL);
  \draw[double equal sign distance] (kXL) to node[above,rotate=30] {$\sim$} (LX);
 \end{tikzpicture}
\end{center}
The isomorphis $\mc{P}_k(W) \cong k[X_1, \dotsc, X_n]$ of $k$-algebras also induces an isomorphism $\mc{P}_k(W)_L \cong k[X_1, \dotsc, X_n]_L$ of $L$-algebras which results in the following commutative diagram.
\begin{center}
 \tikzsetnextfilename{commuting_prism_left_side}
 \begin{tikzpicture}[node distance = 6em]
  \node (Pk) {$\mc{P}_k(W)$};
  \node (PkL) [left = 6em of Pk] {$\mc{P}_k(W)_L$};
  \node (kX) [below of = Pk]{$k[X_1, \dotsc, X_n]$};
  \node (kXL) [below of = PkL] {$k[X_1, \dotsc, X_n]_L$};
  \draw[left hook ->] (Pk) to (PkL);
  \draw[left hook ->] (kX) to (kXL);
  \draw[double equal sign distance] (Pk) to node[right] {$\wr$} (kX);
  \draw[double equal sign distance] (PkL) to node[right] {$\wr$} (kXL);
 \end{tikzpicture}
\end{center}
We also have the following commutative diagram of $L$-algebras and isomorphisms of such.
\begin{center}
 \tikzsetnextfilename{commuting_prism_front_side}
 \begin{tikzpicture}[node distance = 6em]
  \node (PkL) {$\mc{P}_k(W)_L$};
  \node [right = 6em of PkL] (PL) {$\mc{P}_L(W_L)$};
  \node [below of = PkL] (kXL) {$k[X_1, \dotsc, X_n]_L$};
  \node [below of = PL] (LX) {$L[X_1, \dotsc, X_n]$};
  \draw[double equal sign distance] (PkL) to node[above] {$\sim$} (PL);
  \draw[double equal sign distance] (kXL) to node[above] {$\sim$} (LX);
  \draw[double equal sign distance] (PkL) to node[right] {$\wr$} (kXL);
  \draw[double equal sign distance] (PL) to node[right] {$\wr$} (LX);
 \end{tikzpicture}
\end{center}
By putting all of this together we get the following nice commutative diagram:
\begin{center}
 \tikzsetnextfilename{commuting_prism}
 \begin{tikzpicture}[node distance = 10em]
  \node (Pk) {$\mc{P}_k(W)$};
  \node (PL) [right = 7em of Pk] {$\mc{P}_L(W_L)$};
  \node (PkL) [below left = 3em and 3em of Pk] {$\mc{P}_k(W)_L$};
  \node (kX) [below of = Pk] {$k[X_1, \dotsc, X_n]$};
  \node (LX) [below of = PL] {$L[X_1, \dotsc, X_n]$};
  \node (kXL) [below of = PkL] {$k[X_1, \dotsc, X_n]_L$};
  \draw[right hook ->] (Pk) to (PL);
  \draw[right hook ->] (kX) to (LX);
  \draw[double equal sign distance] (Pk) to node[right] {$\wr$} (kX);
  \draw[double equal sign distance] (PL) to node[right] {$\wr$} (LX);
  \draw[left hook ->] (Pk) to (PkL);
  \draw[left hook ->] (kX) to (kXL);
  \draw[double equal sign distance] (PkL) to node[right] {$\wr$} (kXL);
  \draw[double equal sign distance, line width = 2.5pt, white] (PkL) to node[above,rotate=15] {$\sim$} (PL);
  \draw[double equal sign distance] (PkL) to node[above,rotate=15] {$\sim$} (PL);
  \draw[double equal sign distance] (kXL) to node[above,rotate=15] {$\sim$} (LX);
 \end{tikzpicture}
\end{center}





\begin{lem}
 Let $W$ be a finite-dimensional $k$-vector space. Let $h \in \mc{P}(W)$ with $h \neq 0$ and
 \[
  W_h \coloneqq \{w \in W \mid h(w) \neq 0\}.
 \]
 Then $W_h$ is Zariski dense.
\end{lem}
\begin{proof}
 Let $f \in \mc{P}(W)$ with $f_{|W_h} = 0$. Then
 \[
  (fh)(w) = f(w)h(w) = 0
 \]
 for all $w \in W$, so $fh = 0$. Since $\mc{P}(W) \cong k[X_1, \dotsc, X_{\dim W}]$ we know that $\mc{P}(W)$ is an integral domain. Since $h \neq 0$ and $fh = 0$ it follows that $f = 0$.
\end{proof}


\begin{cor}
 $\GL_n(k)$ is Zariski-dense in $\Mat_n(k)$.
\end{cor}
\begin{proof}
 We know that $\det \in \mc{P}(\Mat_n(k))$ with $\det \neq 0$. Since
 \[
  {\Mat_n(k)}_{\det} = \{A \in \Mat_n(k) \mid \det A \neq 0\} = \GL_n(k)
 \]
 we find that $\GL_n(k)$ is Zariski-dense in $\Mat_n(k)$.
\end{proof}


\begin{prop}
 Let $W$ be a finite-dimensional $k$-vector space and $X \subseteq Y \subseteq Z \subseteq W$ such that $X$ is Zariski-dense in $Y$ and $Y$ is Zariski-dense in $Z$. Then $X$ is Zariski-dense in $Z$.
\end{prop}
\begin{proof}
 Let $f \in \mc{P}(W)$ with $f_{|X} = 0$. Because $X$ is Zariski dense in $Y$ it follows that $f_{|Y} = 0$. Because $Y$ is Zariski dense in $Z$ it follows that $f_{|Z} = 0$.
\end{proof}


\begin{lem}\label{lem: zariski density orbits}
 Let $W$ be a finite-dimensional representation of a group $G$ and $f \in \mc{P}(W)^G$.
 \begin{enumerate}[a)]
  \item
  Let $X \subseteq W$ such that $f_{|X} = 0$ and
  \[
   G.X = \{g.x \mid g \in G, x \in X\}
  \]
  is Zariski-dense in $W$. Then $f = 0$.
  \item
  If there is a Zariski dense $G$-orbit then $f$ is constant.
 \end{enumerate}
\end{lem}
\begin{proof}\leavevmode
 \begin{enumerate}[a)]
  \item
  Since $f$ is $G$-equivariant it follows that $f_{|G.X} = 0$, since for all $g \in G$ and $x \in X$
  \[
   f(g.x) = \left(g^{-1}.f\right)(x) = f(x) = 0.
  \]
  Because $G.X$ is Zariski dense in $W$ it further follows that $f = 0$.
  \item
  Let $x \in X$ such that $G.x$ is Zariski dense in $W$. Since $f$ is $G$-equivariant it is constant on $G$-orbits. Therefore $f-f(x)$ vanishes on the Zariski dense $G$-orbit $G.x$. Therefore $f-f(x) = 0$ and $f = f(x)$.
 \end{enumerate}
\end{proof}


\begin{prop}
 Let $k$ be an algebraically closed field and
 \[
  \Diag_n(k) \coloneqq \{A \in \Mat_n(k) \mid \text{$A$ is diagonalizable}\}.
 \]
 Then $\Diag_n(k)$ is Zariski-dense in $\Mat_n(k)$.
\end{prop}
\begin{proof}
 Let $f \in \mc{P}(\Mat_n(k))$ with $f_{|\Diag_n(k)} = 0$ and $A \in \Mat_n(k)$. Since $k$ is algebraically closed we find $S \in \GL_n(k)$ such that $SAS^{-1}$ is in Jordan normal form with eigenvalues $b_1$, \dots, $b_n$ (not necessarily pairwise distinct).
 
 Let $a_1, \dotsc, a_n \in k^\times$ be pairwise different (this is possible since $k$ is infinite). We define
 \[
  D \colon k \to \Mat_n(k), z \mapsto
  \begin{pmatrix}
   a_1 z &       &        &       \\
         & a_2 z &        &       \\
         &       & \ddots &       \\
         &       &        & a_n z
  \end{pmatrix}.
 \]
 We also set
 \[
  M \colon k \to \Mat_n(k), z \mapsto SAS^{-1} + D(z)
 \]
 and
 \[
  \varphi \colon k \to \Mat_n(k), z \mapsto S^{-1} M(z) S = S^{-1}(SAS^{-1}+D(z))S.
 \]
 Notice that $\varphi(0) = A$ and that $\varphi(z)$ has the eigenvalues $b_1 + a_1 z$, \dots, $b_n + a_n z$ for all $z \in \C$. It is easy to see that these eigenvalues are distinct for all but finitely many $z \in \C$ (since for all $1 \leq i < j \leq n$ there exists exactly one $z_{ij} \in \C$ with $b_i + a_i z_{ij} = b_j + a_j z_{ij}$). Therefore $\varphi(z)$ is diagonalizable for all but finitely many $z \in \C$.
 
 Since $f_{|\Diag_n(k)} = 0$ it follows that $(f \circ \varphi)(z) = 0$ for all but finitely many $z \in \C$. Therefore $f \circ \varphi = 0$. In particular
 \[
  f(A) = f(\varphi(0)) = (f \circ \varphi)(0) = 0.
 \]
\end{proof}


\begin{cor}
 Let $k$ be an algebraically closed field and let $\GL_n(k)$ act on $\Mat_n(k)$ by conjugation. For $f \in \mc{P}(\Mat_n(k))^{\GL_n(k)}$ with $f_{|D} = 0$ we then have $f = 0$. (As usual $D$ denotes the set of diagonal matrices in $\Mat_n(k)$.)
\end{cor}
\begin{proof}
 Since $\GL_n(k).D = \Diag_n(k)$ is Zariski dense in $\Mat_n(k)$ this directly follows from lemma \ref{lem: zariski density orbits}.
\end{proof}


\begin{defi}
 Let $W$ be a finite-dimensional $k$-vector space. For a subset $X \subseteq W$ we define
 \[
  \mc{I}_k(X) \coloneqq \{ f \in \mc{P}_k(W) \mid f(x) = 0 \text{ for all } x \in X \}.
 \]
 $\mc{I}_k(X)$ is called the vanishing ideal of $X$. We also write $\mc{I}(X)$ instead of $\mc{I}_k(X)$ if it is clear over which field we work.
 For every point $a \in W$ we set
 \[
  \mf{M}_a \coloneqq \mc{I}(\{a\}) = \{f \in \mc{P}(W) \mid f(a) = 0\}.
 \]
\end{defi}


\begin{rem}
 As the name suggests the vanishing ideal $\mc{I}(X)$ of a subset $X \subseteq W$ is a two-sided ideal in $\mc{P}(W)$.
\end{rem}


\begin{rem}
 Let $W$ be a finite-dimensional $k$-vector space.
 \begin{enumerate}[a)]
  \item
  For $X \subseteq Y \subseteq W$ we have $\mc{I}(Y) \subseteq \mc{I}(X)$. Furthermore $X$ is Zariski-dense in $Y$ if and only if $\mc{I}(X) = \mc{I}(Y)$.
  \item
  Let $\{X_i\}_{i \in I}$ be a collection of subsets $X_i \subseteq W$. Then
  \[
   \mc{I}\left( \bigcup_{i \in I} X_i \right) = \bigcap_{i \in I} \mc{I}(X_i).
  \]
 \end{enumerate}
\end{rem}


\begin{lem}
 For $a = (a_1, \dotsc, a_n) \in k^n$ the ideal
 \[
  (X_1 - a_1, \dotsc, X_n - a_n) \in k[X_1, \dotsc, X_n]
 \]
 is maximal and
 \[
  \mf{M}_a = (X_1 - a_1, \dotsc, X_n - a_n).
 \]
 (We identify $k[X_1, \dotsc, X_n]$ with $\mc{P}(k^n)$ under the isomorphism which identifies $X_i$ with the $i$-th coordinate function $\varphi_i$.)
\end{lem}
\begin{proof}
 We write $\mf{M} \coloneqq (X_1 - a_1, \dotsc, X_n - a_n)$. We define the evaluation map
 \[
  \varepsilon_a \colon k[X_1, \dotsc, X_n] \to k, f \mapsto f(a).
 \]
 $\varepsilon_a$ is an surjective ringhomomorphism, and thus induces an isomorphism of rings
 \[
  k[X_1, \dotsc, X_n]/\ker \varepsilon_a \to k.
 \]
 Since $k$ is a field we find that $\ker \varepsilon_a$ is a maximal ideal. We also have
 \[
  \ker \varepsilon_a = \mf{M}_a.
 \]
 
 It is clear that $\mf{M} \subseteq \ker \varepsilon_a$. Therefore we get a surjective ring homomorphism
 \[
  \varepsilon_\mf{M} \colon k[X_1, \dotsc, X_n]/\mf{M} \to k.
 \]
 $\varepsilon_\mf{M}$ is injective, since for the ring homomorphism
 \[
  \psi \colon k \to k[X_1, \dotsc, X_n]/\mf{M}, \lambda \mapsto \lambda + \mf{M}
 \]
 we have $\varepsilon_\mf{M} \circ \psi = \id_k$. Since $\varepsilon_\mf{M}$ is injective we have
 \[
  0 = \ker \varepsilon_\mf{M} \cong \ker \varepsilon_a / \mf{M}.
 \]
 So $\mf{M} = \ker \varepsilon = \mf{M}_a$.
\end{proof}

More generally: If $W$ is a finite-dimensional $k$-vector space, $w_1$, \dots, $w_n$ a $k$-basis of $W$ and $\varphi_1$, \dots, $\varphi_n$ the corresponding coordinate functions then for every $w = \sum_{i=1}^n \lambda_i w_i \in W$
\[
 \mc{I}_k(\{w\}) = (\varphi_1 - w_1, \dotsc, \varphi_n - w_n)_{\mc{P}_k(W)}.
\]


\begin{lem}
 Let $L/k$ be a field extension and $W$ a finite-dimensional $k$-vector space. For a subset $X \subseteq W \subseteq W_L$ we have
 \[
  \mc{I}_k(X)_L = \mc{I}_L(X).
 \]
 (We identify $\mc{P}_k(W)_L$ with $\mc{P}_L(W_L)$ via the isomorphism $\mc{P}_k(W)_L \cong \mc{P}_L(W_L)$.)
\end{lem}
\begin{proof}
 Let $w_1$, \dots, $w_n$ be a $k$-basis of $W$. For every point $w = \sum_{i=1}^n \lambda_i w_i$ we have
 \begin{align*}
  \mc{I}_L(\{w\})
  &= (\varphi_1 - w_1, \dotsc, \varphi_n - w_n)_{\mc{P}_L(\{w\})} \\
  &= L \otimes_k (\varphi_1 - w_1, \dotsc, \varphi_n - w_n)_{\mc{P}_k(\{w\})} \\
  &= L \otimes_k \mc{I}_k(\{w\})
  = \mc{I}_k(\{w\})_L.
 \end{align*}
 For every subset $X \subseteq W$ we therefore have
 \begin{align*}
  \mc{I}_k(X)_L
  &= L \otimes_k \mc{I}_k(X)
  = L \otimes_k \mc{I}_k\left(\bigcup_{x \in X} \{x\}\right) \\
  &= L \otimes_k \bigcap_{x \in X} \mc{I}_k(\{x\})
  = \bigcap_{x \in X} L \otimes_k \mc{I}_k(\{x\}) \\
  &= \bigcap_{x \in X} \mc{I}_k(\{x\})_L
  = \bigcap_{x \in X} \mc{I}_L(\{x\})
  = \mc{I}_L(X).
 \end{align*}
\end{proof}


\begin{cor}\label{cor: Zariski dense scalar extension}
 Let $W$ be a finite-dimensional $k$-vector space and
 \[
  X \subseteq Y \subseteq W \subseteq W_L.
 \]
 If $X$ is Zariski dense in $Y$ over $k$ then it is so over $L$.
\end{cor}
\begin{proof}
 Because $X$ is Zariski dense in $Y$ over $k$ we have
 \[
  \mc{I}_k(X) = \mc{I}_k(Y).
 \]
 It follows that
 \[
  \mc{I}_L(X) = \mc{I}_k(X)_L = \mc{I}_k(Y)_L = \mc{I}_L(Y),
 \]
 so $X$ is Zariski dense in $Y$ over $L$.
\end{proof}


\begin{prop}
 Let $L/k$ be a field extension.
 \begin{enumerate}[a)]
  \item
  $\GL_n(k)$ is Zariski dense in $\Mat_n(L)$ over $L$.
  \item
  $\GL_n(k)$ is Zariski dense in $\GL_n(L)$ as subsets of $\Mat_n(L)$ over $L$.
  \item
  $\SL_n(k)$ is Zariski dense in $\SL_n(L)$ as subsets of $\Mat_n(L)$ over $L$.
 \end{enumerate}
\end{prop}
\begin{proof}\leavevmode
 \begin{enumerate}[a)]
  \item
  $\GL_n(k)$ is Zariski dense in $\Mat_n(k)$ over $k$. By corollary \ref{cor: Zariski dense scalar extension} we find that $\GL_n(k)$ is Zariske dense in $\Mat_n(k)$ as subsets of $\Mat_n(k)_L \cong \Mat_n(L)$ over $L$. By \mbox{lemma \ref{lem: W Zariski dense in W_L}} $\Mat_n(k)$ is Zariski dense in $\Mat_n(L) \cong \Mat_n(k)_L$ over $L$. By the transitivity of Zariski density we find that $\GL_n(k)$ is Zariski dense in $\Mat_n(L)$ over $L$.
  \item
  This follows directly from a).
  \item
  The proof given in the lecture is wrong. A right one will be added later.
  \qedhere
 \end{enumerate}
\end{proof}


































