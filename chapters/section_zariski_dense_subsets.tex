\section{Zariski Dense Subsets}


\begin{fluff}
  Parts of this section are taken from \cite[\S 1.3]{InvariantPrimer}.
\end{fluff}


\begin{conventions}
  For this section let $k$ be an infinite field.
\end{conventions}


\begin{definition}
  \label{definition: Zariski density}
  Let $V$ be a finite-dimensional $k$-vector space.
  A subset $X \subseteq V$ is \emph{Zariski dense \textup(over $k$\textup)} if for every polynomial map $f \colon V \to k$ we have that
  \[
              \restrict{f}{X} = 0
    \implies  f = 0 \,.
  \]
  If $X \subseteq Y \subseteq V$ then \emph{$X$ is Zariski dense in $Y$ \textup(over $k$\textup)} if for every polynomial function $f \colon V \to k$ we have that
  \[
              \restrict{f}{X} = 0
    \implies  \restrict{f}{Y} = 0 \,.
  \]
\end{definition}


\begin{example}
  Let $V$ be a finite-dimensional $k$-vector space.
  \begin{enumerate}
    \item 
      Any infinite subset $X \subseteq k$ is Zariski dense:
      Let $f \colon V \to k$ be a polynomial function with $\restrict{f}{X} = 0$.
      There exists some polynomial $p \in k[X]$ with $f(\lambda) = p(\lambda)$ for all $\lambda \in k$ because $f$ is polynomial.
      It follows from $\restrict{f}{X} = 0$ that every $x \in X$ is a zero of $p$, which shows that $p$ has infinitley many zeroes.
      This can only be the case for $p = 0$, and thus $f = 0$.
    \item
      Let $U \subsetneq V$ be a proper $k$-linear subspace.
      Then $U$ is not Zariski dense in $V$ over $k$:
      To see this let $v_1, \dotsc, v_m, v_{m+1}, \dotsc, v_n$ be a $k$-basis of $V$ such that $v_1, \dotsc, v_m$ is a $k$-basis of $U$.
      Then $m < n$ because $U$ is a proper subspace of $V$.
      Let $\pi \colon V \to k$ be the projection onto the last coordinate, i.e.
      \[
          \pi\left( \lambda_1 v_1 + \dotsb + \lambda_n v_n \right)
        = \lambda_n
      \]
      for all $\lambda_1, \dotsc, \lambda_n \in k$.
      We then have that $\restrict{\pi}{U} = 0$ but $\pi \neq 0$, which shows that $U$ is not Zariski dense in $V$ over $k$.
    \item
      Let $k$ be a finite field.
      We have seen in Remark~\ref{remark: polynomial functions over infinite fields} that every function $f \colon V \to k$ is a polynomial function.
      It follows that the only Zariski-dense subset $X \subseteq V$ is $X = V$ itself.
  \end{enumerate}
\end{example}


\begin{warning}
  The previous examples show that the notion of Zariski density depend on the choice of the underlying field $k$:
  It follows from the first example that $\Real \subseteq \Complex$ is Zariski dense over $\Complex$, while it follows from the second example that $\Real \subseteq \Complex$ is not Zariski dense over $\Real$.
\end{warning}


\begin{lemma}
  \label{lemma: non-vanishing set is dense}
  Let $V$ be a finite-dimensional $k$-vector space and let $h \colon V \to k$ be a non-zero polynomial function.
  Then the non-vanishing set
  \[
              V_h
    \defined  \{
                v \in V
              \suchthat
                h(v) \neq 0
              \}
  \]
  is Zariski dense in $V$.
\end{lemma}
\begin{proof}
  Let $f \colon V \to k$ be a polynomial function with $\restrict{f}{V_h} = 0$.
  Then
  \[
      (fh)(v)
    = f(v)h(v)
    = 0
  \]
  for all $v \in V$, and thus $fh = 0$.
  The $k$-algebra $\mc{P}(V) \cong k[X_1, \dotsc, X_{(\dim V)}]$ is an integral domain.
  It therefore follows from $fh = 0$ and $h \neq 0$ that $f = 0$.
\end{proof}


\begin{corollary}[First Zariski density property]
  \label{corollary: GLn is Zariski dense in Mn}
  The subset $\GL_n(k) \subseteq \Mat_n(k)$ is Zariski dense.
\end{corollary}


\begin{proof}
  The group $\GL_n(k)$ is the non-vanishing set of $\det \colon \Mat_n(k) \to k$.
\end{proof}


\begin{lemma}
  \label{lemma: zariski density orbits}
  Let $V$ be a finite-dimensional representation of a group $G$ and let $f \colon V \to k$ be a $G$-invariant polynomial function.
  Suppose that $X \subseteq V$ is a subset such that that the orbit
  \[
      G.X
    = \{
        g.x
      \mid
        g \in G,
        x \in X
      \}
  \]
  is Zariski-dense in $V$.
  If $\restrict{f}{X} = 0$ then $f = 0$.
\end{lemma}


\begin{proof}
  It follows from the $G$-invariance of $f$ that $\restrict{f}{G.X} = 0$ because
  \[
      f(g.x)
    = \left( g^{-1}.f \right)(x)
    = f(x)
    = 0
  \]
  for all $g \in G$, $x \in X$.
  It follows that $f = 0$ because $G.X$ is Zariski dense in $V$.
\end{proof}


\begin{proposition}
  \label{proposition: diagonalizable matrices are dense for algebraically closed}
  If $k$ is algebraically closed then the set of diagonalizable matrices,
  \[
              \Diag_n(k)
    \defined  \{
                A \in \Mat_n(k)
              \mid
                \text{$A$ is diagonalizable}
              \} \,,
  \]
  is Zariski-dense in $\Mat_n(k)$.
\end{proposition}


\begin{proof}
  Let $f \colon \Mat_n(k) \to k$ with $\restrict{f}{\Diag_n(k)} = 0$ and let $A \in \Mat_n(k)$.
  The matrix $A$ is triangularizable over $k$ because $k$ is algebraically closed, so there exists some $S \in \GL_n(k)$ such that $S A S^{-1}$ is an upper triangular matrix with diagonal entries $b_1, \dotsc, b_n \in k$ (not necessarily pairwise distinct).
  
  We want to \enquote{deform} the matrix $A$ to make it diagonalizable:
  
  Let $a_1, \dotsc, a_n \in k$ be pairwise different (such $a_i$ exist because $k$ is infinite), and consider the map $M \colon k \to \Mat_n(k)$ given by
  \[
              M(z)
    \defined  S^{-1}
              \left(
              S A S^{-1}
              + z
              \begin{bmatrix}
                a_1 &         &     \\
                    & \ddots  &     \\
                    &         & a_n
              \end{bmatrix}
              \right)
              S
  \]
  for all $z \in k$.
  Then $M(0) = A$, so one may think of $M(z)$ as a \enquote{deformation} of $A$ along a parameter $z \in k$.
  Note that $M(z)$ has the eigenvalues $b_1 + a_1 z, \dotsc, b_n + a_n z$ because
  \begin{align*}
      S M(z) S^{-1}
    =     S A S^{-1}
        + z
        \begin{bmatrix}
          a_1 &         &     \\
              & \ddots  &     \\
              &         & a_n
        \end{bmatrix}
    &=  \begin{bmatrix}
          b_1 & \cdots  & *       \\
              & \ddots  & \vdots  \\
              &         & b_n
        \end{bmatrix}
        + z
        \begin{bmatrix}
          a_1 &         &     \\
              & \ddots  &     \\
              &         & a_n
        \end{bmatrix} \\
    &=  \begin{bmatrix}
          b_1 + z a_1 & \cdots  & *           \\
                      & \ddots  & \vdots      \\
                      &         & b_n + z a_n
        \end{bmatrix}.
  \end{align*}
  Any two eigenvalues $b_i + a_i z$ and $b_j + a_j z$ of $M(z)$ coincide for only one value of $z$, namely for $z = (b_j - b_i)/(a_i - a_j)$.
  It follows that $M(z)$ has pairwise different eigenvalues, and is therefore digonalizable, for all but finitely many $z \in k$.
  
  It follows from $\restrict{f}{\Diag_n(k)} = 0$ that $(f \circ M)(z) = 0$ for all but finitely many $z \in k$, and therefore that $f \circ M = 0$.
  For $z = 0$ we find that
  \[
      0
    = (f \circ M)(0)
    = f(M(0))
    = f(A) \,.
  \]
  This shows that $f(A) = 0$ for every $A \in \Mat_n(k)$, i.e.\ that $f = 0$.
\end{proof}


\begin{remark}
  The above proof actually shows that the set of matrices with pairwise different eigenvalues is Zariski dense if $k$ is algebraically closed.
\end{remark}


\begin{remark}
  Proposition~\ref{proposition: diagonalizable matrices are dense for algebraically closed} can also be shown by using Lemma~\ref{lemma: non-vanishing set is dense}:
  
  Recall from Example~\ref{example: multiple roots via symmetric polynomials} that there exists a polynomial $\Delta \in k[Y_1, \dotsc, Y_n]$ such that a monic polynomial $X^n + a_{n-1} X^{n-1} + \dotsb + a_1 X + a_0 \in k[X]$ has a multiple root in $k$ (which is algebraically closed) if and only if $\Delta(a_{n-1}, \dotsc, a_0) = 0$.
  If the characteristic polynomial of $A \in \Mat_n(k)$ is given $\chi_A(X) = X^n + s_{n-1}(A) X^{n-1} + \dotsb + s_1(A) X + s_0(A)$ the the $s_i \colon \Mat_n(k) \to k$ are polynomial functions and it follows that
  \[
            d
    \colon  \Mat_n(k)
    \to     k,
    \quad   A
    \mapsto \Delta(s_{n-1}(A), \dotsc, s_0(A))
  \]
  is a polynomial function.
  For every matrix $A \in \Mat_n(k)$ we have that
  \begin{align*}
        &\, d(A) = 0  \\
    \iff&\, \text{$\chi_A$ has a multiple root} \\
    \iff&\, \text{$A$ has a eigenvalue with (algebraic) multiplicity $\geq 2$} \,,
  \end{align*}
  and therefore that
  \[
          d(A) \neq 0
    \iff  \text{$A$ has pairwise different eigenvalues} \,.
  \]
  The set of matrices with pairwise different eigenvalues is non-empty and the non-vanishing set of $d$, and thus Zariski dense by Lemma~\ref{lemma: non-vanishing set is dense}.
  
  Instead of using the \hyperref[theorem: fundamental theorem of symmetric functions]{fundamental theorem of symmetric functions} to justify the existence of the polynomial $\Delta$ as done in Example~\ref{example: multiple roots via symmetric polynomials} one can also use the following explicit construction:
  \begin{itemize}
    \item
      For every two polynomials $f, g \in k[X]$ with $f = a_n X^n + \dotsb + a_1 X + a_0$ and $g = b_m X^m + \dotsb + b_1 X + b_0$ their \emph{Sylvester matrix} is the $((n+m) \times (n+m))$-matrix $S(f,g)$ such that
      \begin{itemize}
        \item
          for $j = 1, \dotsc, m$ the $j$-th column contains the coefficients $a_n, \dotsc, a_0$ starting in the $j$-the row, and
        \item
          for $j = m+1, \dotsc, m+n$ the $(m+j')$-th column contains the coefficients $b_m, \dotsc, b_0$ starting in the $j'$-th row.
      \end{itemize}
      If for example $f = a_4 X^4 + a_3 X^3 + a_2 X^2 + a_1 X + a_0$ and $g = b_3 X^3 + b_2 X^2 + b_1 X + b_0$ then the Sylvester Matrix $S(f,g)$ is the $(7 \times 7)$-matrix given by
      \[
          S(f,g)
        = \begin{bmatrix}
            a_4 &     &     & b_3 &     &     &     \\
            a_3 & a_4 &     & b_2 & b_3 &     &     \\
            a_2 & a_3 & a_4 & b_1 & b_2 & b_3 &     \\
            a_1 & a_2 & a_3 & b_0 & b_1 & b_2 & b_3 \\
            a_0 & a_1 & a_2 &     & b_0 & b_1 & b_2 \\
                & a_0 & a_1 &     &     & b_0 & b_1 \\
                &     & a_0 &     &     &     & b_0
          \end{bmatrix}.
      \]
      For $y = (y_{n-1}, y_{n-2}, \dotsc, y_0) \in k^n$ we denote by $y(X) \in k[X]$ the polynomial
      \[
                  y(X)
        \defined  y_{n-1} X^{n-1} + \dotsb + y_1 X + y_0 \,.
      \]
      We then have for all $y \in k^n$, $z \in k^m$ that
      \[
              S(f,g) \cdot \vect{y \\ z} = 0
        \iff  f(X) \cdot y(X) + g(X) \cdot z(X) = 0 \,,
      \]
      so
      \[
          \ker S(f,g)
        = \left\{
                \vect{y \\ z}
            \in \vect{k^n \\ k^m}
            =   k^{n+m}
          \suchthat*
            y(X) f(X) + z(X) g(Z) = 0
          \right\}
      \]
      It then follows that $\deg(\gcd(f,g)) = m + n - \rank S(f,g)$. % TODO: How ?!
      It follows that $S(f,g)$ is invertible if and only if $\deg(\gcd(f,g)) = 0$, i.e.\ if and only if $f, g$ are coprime.
    \item
      If $f \in K[X]$ is a polynomial of degree $\leq n$ then $f$ has a multiple root in $k$ if and only if $f, f'$ are not coprime, i.e.\ if and only if $\Delta(f) \neq 0$ for
      \[
                  \Delta(f)
        \defined  \det S(f,f') \,,
      \]
      where $\Delta$ is polynomial in $f$.
  \end{itemize}
  For $f = X^2 + aX + b$ we have that $f' = 2X + a$ and therefore
  \[
      \Delta(f)
    = \det S(f,f')
    = \det
      \begin{bmatrix}
        1 & 2 &   \\
        a & a & 2 \\
        b &   & a
      \end{bmatrix}
    = a^2 + 4b - 2a^2
    = 4b - a^2 \,,
  \]
  and for $f = X^3 + aX^2 + bX + c$ we have that $f' = 3X^2 + 2aX + b$ and therefore
  \begin{align*}
        \Delta(f)
     =  \det S(f,f')
    &=  \det
        \begin{bmatrix}
          1 &   & 3   &     &     \\
          a & 1 & 2a  & 3   &     \\
          b & a & b   & 2a  & 3   \\
          c & b &     & b   & 2a  \\
            & c &     &     & b
        \end{bmatrix} \\
    &=  4 a^3 c - a^2 b^2 - 18 a b c + 4 b^3 + 27 c^2 \,.
  \end{align*}
\end{remark}


\begin{corollary}[Second Zariski density property for algebraically closed fields]
  \label{corollary: second Zariski density property for algebraically closed fields}
  Let $k$ be an algebraically closed field and let $\GL_n(k)$ act on $\Mat_n(k)$ by conjugation.
  Let $f \in \Mat_n(k) \to k$ be a $\GL_n(k)$-invariant polynomial function and let $D \subseteq \Mat_n(k)$ be the subset of diagonal matrices.
  If $\restrict{f}{D} = 0$ then $f = 0$.
\end{corollary}


\begin{proof}
  This follows from Lemma~\ref{lemma: zariski density orbits} because the orbit $\GL_n(k).D = \Diag_n(k)$ is Zariski dense in $\Mat_n(k)$ by Proposition~\ref{proposition: diagonalizable matrices are dense for algebraically closed}.
\end{proof}





\subsection*{Extension of scalars}


\begin{fluff}
  The first of the Zariski density properties stated in Proposition~\ref{proposition: zariski density properties} has been proven by Corollary~\ref{corollary: GLn is Zariski dense in Mn}, but we have only shown the \hyperref[corollary: second Zariski density property for algebraically closed fields]{second Zariski density property for algebraically closed fields}.
  
  To show that the second Zariski density property holds for arbitrary infinite fields we now examine how Zariski density changes under extension of scalars.
\end{fluff}


\begin{conventions}
  In the following let $L/k$ be a field extension.
  For every $k$-vector space $V$ we denote by $V_L = L \otimes_k V$ the extension of scalars of $V$, and regard $V$ as a $k$-linear subspace of $V_L$ (see Appendix~\ref{appendix: extension of scalars} for a short introduction to extension of scalars).
  If $V$ is finite dimensional then we abbreviate $\mc{P}(V) = \mc{P}_k(V)$ and $\mc{P}(V_L) = \mc{P}_L(V_L)$.
\end{conventions}


\begin{lemma}
  \label{lemma: product of Zariski dense is again Zariski dense}
  Let $V$, $W$ be $k$-vector spaces and let $X \subseteq V$ and $Y \subseteq W$ be Zariski dense.
  Then $X \times Y \subseteq V \times W$ is again Zariski dense.
\end{lemma}


\begin{proof}
  Let $f \colon V \times W \to k$ be a polynomial function with $\restrict{f}{X \times Y} = 0$.
  We then have that
  \[
      f(x,y)
    = 0
    \qquad
    \text{for all $x \in X$, $y \in Y$} \,.
  \]
  For fixed $x \in X$ the map $f(x,-) \colon W \to k$ is polynomial with $\restrict{f(x,-)}{Y} = 0$, so it follows that $f(x,-) = 0$ because $Y$ is Zariski dense in $W$.
  This shows that
  \[
      f(x,w)
    = 0
    \qquad
    \text{for all $x \in X$, $w \in W$}.
  \]
  For fixed $w \in W$ the map $f(-,w) \colon V \to k$ is polynomial with $\restrict{f(-,w)}{X} = 0$, so it follows that $f(-,w) = 0$ because $X$ is Zariski dense in $V$.
  This shows that
  \[
      f(v,w)
    = 0
    \qquad
    \text{for all $v \in V$, $w \in W$} \,,
  \]
  and therefore that $f = 0$.
\end{proof}


\begin{corollary}
  \label{corollary: kn is Zariski dense in Ln}
  The subset $k^n \subseteq L^n$ is Zariski dense over $L$.
\end{corollary}


\begin{proof}
  This follows from Lemma~\ref{lemma: product of Zariski dense is again Zariski dense} because $k \subseteq L$ is Zariski dense over $L$ (because $k$ is infinite).
\end{proof}



% \begin{proof}
%   We show the statement by induction over $n \geq 0$.
%   For $n = 0$ the statement holds because $k^n = 0 = L^n$.
%   So let $n \geq 1$, and suppose that the statemen holds for $n-1$.
%   
%   Let $f \in \mc{P}(L^n)$ with $\restrict{f}{k^n} = 0$.
%   There exists some polynomial $p \in L[X_1, \dotsc, X_n]$ with $f((\lambda_1, \dotsc, \lambda_n)) = p(\lambda_1, \dotsc, \lambda_n)$ for all $(\lambda_1, \dotsc, \lambda_n) \in L^n$ because $f$ is a polynomial function.
%   We may write $p$ as
%   \[
%       p(X_1, \dotsc, X_n)
%     = \sum_{i=0}^\infty p_i(X_1, \dotsc, X_{n-1}) X_n^i
%   \]
%   with $p_i \in L[X_1, \dotsc, X_{n-1}]$ for all $i \geq 0$ and $p_i \neq 0$ for only finitely many $i$.
%   
%   Let $(\lambda_1, \dotsc, \lambda_{n-1}) \in k^{n-1}$ and consider the polynomial $\bar{p} \in L[X_n]$ given by
%   \[
%               \bar{p}(X_n)
%     \coloneqq p(\lambda_1, \dotsc, \lambda_{n-1}, X_n)
%     =         \sum_{i=0}^\infty p_i(\lambda_1, \dotsc, \lambda_{n-1}) X_n^i \,.
%   \]
%   Then $\bar{p}(\lambda_n) = 0$ for all $\lambda_n \in k$, and it follows that $\bar{p} = 0$ (because $\bar{p}$ has infinitely many zeroes).
%   It follows that all coefficients of $\bar{p}$ vanish, i.e.\ that $p_i(\lambda_1, \dotsc, \lambda_{n-1}) = 0$ for all $i \geq 0$, because $L$ is infinite.
%   
%   This shows that the polynomials $p_i$ vanish on all of $k^{n-1}$, which by induction hypothesis implies that they vanish on all of $L^{n-1}$.
%   It follows that $p_i = 0$ for all $i \geq 0$ because $L$ is infinite.
%   This shows that $p = 0$ and thus $f = 0$.
% \end{proof}


\begin{corollary}
  \label{corollary: V is Zariski dense in VL}
  Let $V$ be a finite-dimensional $k$-vector space.
  Then $V$ is Zariski dense in $V_L$ over $L$.
\end{corollary}


\begin{proof}
  Let $v_1, \dotsc, v_n$ be a $k$-basis of $V$.
  Then $1 \otimes v_1, \dotsc, 1 \otimes v_n$ is an $L$-basis of $V_L$.
  The isomorphism of $L$-vector spaces $\varphi \colon L^n \to V_L$ with $\varphi(e_i) = 1 \otimes v_i$ maps $k^n \subseteq L^n$ onto $\varphi(k^n) = V$.
  The statement now follows from Corollary~\ref{corollary: kn is Zariski dense in Ln} because $\varphi$ is a polynomial isomorphism, since both $\varphi$ and $\varphi^{-1}$ are linear and therefore polynomial.
\end{proof}


\begin{proposition}
  \label{proposition: consistent choice of identification for polynomial functions}
  Let $V$ be a finite-dimensional $k$-vector space.
  \begin{enumerate}
    \item
      Every $k$-polynomial map $f \colon V \to k$ extends uniquely to an $L$-polynomial map $\overline{f} \colon V_L \to L$ with
      \[
          \overline{f}(1 \otimes v)
        = f(v)
      \]
      for all $v \in V$.
    \item
      The map $i \colon \mc{P}(V) \to \mc{P}(V_L)$, $f \mapsto \overline{f}$ is a homomorphism of $k$-algebras, which extends to an isomorphism of $L$-algebras
      \[
                                I
        \colon                  \mc{P}(V)_L
        \xrightarrow{\,\sim\,}  \mc{P}(V_L)
      \]
    \item
      Let $v_1, \dotsc, v_n$ be a $k$-basis of $V$ and let $\varphi_1, \dotsc, \varphi_n \in \mc{P}(V)$ be the corresponding coordinate functions.
      Let $\psi_1, \dotsc, \psi_n \in \mc{P}(V_L)$ be the coordinate functions corresponding to the basis $1 \otimes v_1, \dotsc, 1 \otimes v_n$ of $V_L$.
      
      Let $\Phi \colon \mc{P}(V) \to k[X_1, \dotsc, X_n]$ be the unique isomorphism of $k$-algebras with $\Phi(\varphi_i) = X_i$ for all $i$, and let $\Psi \colon \mc{P}(V_L) \to L[X_1, \dotsc, X_n]$ be the unique isomorphism of $L$-algebras with $\Psi(\psi_i) = X_i$ for all $i$.
      
      Then the following diagram commutes:
      \begin{equation}
        \label{equaton: commuting prim}
        \begin{tikzcd}[row sep = large]
            {}
          & \mc{P}(V)
            \arrow{dl}[above left]{\can}
            \arrow{dr}[above right]{i}
            \arrow{dd}[near start, left]{\Phi}
          & {}
          \\
            \mc{P}(V)_L
            \arrow[crossing over]{rr}[near start, above]{I}
            \arrow{dd}[left]{\Phi_L}
          & {}
          & \mc{P}(V_L)
            \arrow{dd}[right]{\Psi}
          \\
            {}
          & k[X_1, \dotsc, X_n]
            \arrow{dl}[above left]{\can}
            \arrow[hook']{dr}
          & {}
          \\
            k[X_1, \dotsc, X_n]_L
            \arrow{rr}[above]{\sim}
          & {}
          & L[X_1, \dotsc, X_n]
        \end{tikzcd}
      \end{equation}
  \end{enumerate}
\end{proposition}


\begin{proof}
    Let $v_1, \dotsc, v_n$ be a $k$-basis of $V$.
    
    There exists a polynomial $p \in k[X_1, \dotsc, X_n]$ with
    \[
        f(\lambda_n v_1 + \dotsb + \lambda_n v_n)
      = p(\lambda_1, \dotsc, \lambda_n)
    \]
    for all $\lambda_1, \dotsc, \lambda_n \in k$ because the the map $f$ is $k$-polynomial.
    We can regard $p$ as a polynomial $p \in L[X_1, \dotsc, X_n]$.
    With respect to the $L$-basis $1 \otimes v_1, \dotsc, 1 \otimes v_n$ of $V_L$ the polynomial $p$ then defines an $L$-polynomial map $\overline{f} \colon V_L \to L$ given by
    \[
        \overline{f}(\lambda_1 (1 \otimes v_1) + \dotsb + \lambda_n (1 \otimes v_n))
      = p(\lambda_1, \dotsc, \lambda_n)
    \]
    for all $\lambda_1, \dotsc, \lambda_n \in L$.
    We have for every $v \in V$ with $v = \sum_{i=1}^n \lambda_i v_i$ that
    \[
        \overline{f}(1 \otimes v)
      = \overline{f}(\lambda_1 (1 \otimes v_1) + \dotsb + \lambda_n (1 \otimes v_n))
      = p(\lambda_1, \dotsc, \lambda_n)
      = f(v) \,.
    \]
    The uniqueness of $\overline{f}$ follows from the Zariski density of $V \subseteq V_L$ over $L$.
    
    Note that the diagram
    \[
      \begin{tikzcd}[sep = large]
          \mc{P}(V)
          \arrow{r}[above]{i}
          \arrow{d}[left]{\Phi}
        & \mc{P}(V_L)
          \arrow{d}[right]{\Psi}
        \\
          k[X_1, \dotsc, X_n]
          \arrow[hook]{r}
        & L[X_1, \dotsc, X_n]
      \end{tikzcd}
    \]
    commutes by the above construction of $i$.
    It follows that
    \[
                                  i
      \colon                      \mc{P}(V)
      \xrightarrow{\,\Phi\,}      k[X_1, \dotsc, X_n]
      \hookrightarrow             L[X_1, \dotsc, X_n]
      \xrightarrow{\,\Psi^{-1}\,} \mc{P}(V_L)
    \]
    is a composition of $k$-algebra homomorphisms, and thus a $k$-algebra homomorphism itself.
    It follows (from Lemma~\ref{lemma: universal property of extension of scalars for algebras}) that $i$ extends uniquely to an $L$-algebra homomorphism $I \colon \mc{P}(V)_L \to \mc{P}(V_L)$ such that the diagram
    \[
      \begin{tikzcd}[sep = large]
          \mc{P}(V)_L
          \arrow[dashed]{r}[above]{I}
        & \mc{P}(V_L)
        \\
          \mc{P}(V)
          \arrow{u}[left]{\can}
          \arrow{ru}[below right]{i}
        & {}
      \end{tikzcd}
    \]
    commutes.
    
    For the commutativity of the diagram~\eqref{equaton: commuting prim} we note that on elements we get the following diagram, which does commute:
    \[
      \begin{tikzcd}[column sep = large]
          {}
        & \varphi_i
          \arrow[mapsto]{dl}
          \arrow[mapsto]{dr}
          \arrow[mapsto]{dd}
        & {}
        \\
          1 \otimes \varphi_i
          \arrow[crossing over, mapsto]{rr}
          \arrow[mapsto]{dd}
        & {}
        & \psi_i
          \arrow[mapsto]{dd}
        \\
          {}
        & X_i
          \arrow[mapsto]{dl}
          \arrow[mapsto]{dr}
        & {}
        \\
          1 \otimes X_i
          \arrow[mapsto]{rr}
        & {}
        & X_i
      \end{tikzcd}
    \]
    It follows that the diagram~\eqref{equaton: commuting prim} commutes because the occuring maps are all algebra homomorphisms and these elements generate their respective algebras (as $L$-algebras for the upper four in the front, and as $k$-algebras for the two in the back).
    
    It remains to show that $I$ is an isomorphism.
    This follows from the commutativity of the diagram~\eqref{equaton: commuting prim} because
    \[
                                  I
      \colon                      \mc{P}(V)_L
      \xrightarrow{\,\Phi_L\,}    k[X_1, \dotsc, X_n]_L
      \xrightarrow{\,\sim\,}      L[X_1, \dotsc, X_n]
      \xrightarrow{\,\Phi^{-1}\,} \mc{P}(V_L)
    \]
    is a composition of isomorphisms.
\end{proof}


\begin{definition}
  \label{definition: vanishing ideal}
  Let $V$ be a finite-dimensional $k$-vector space.
  \begin{enumerate}
    \item
      For $X \subseteq V$ the \emph{vanishing ideal of $X$} is given by
      \[
        \mc{I}_k(X)
        \defined  \{
                    f \in \mc{P}_k(V)
                  \suchthat
                    \text{$f(x) = 0$ for all $x \in X$}
                  \} \,.
      \]
      We also write $\mc{I}(X)$ instead of $\mc{I}_k(X)$ if the field $k$ is clear from the context.
    \item
      For every point $a \in V$ we set
      \[
                  \mf{m}_a
        \defined  \mc{I}(\{a\})
        =         \{
                    f \in \mc{P}(V)
                  \suchthat
                    f(a) = 0
                  \} \,.
      \]
  \end{enumerate}
\end{definition}


\begin{lemma}
  \label{lemma: basic properties of I}
  Let $V$ be a finite-dimensional $k$-vector space.
  \begin{enumerate}
    \item
      For every subset $X \subseteq V$ the vanishing ideal $\mc{I}(X)$ is an ideal in $\mc{P}(V)$.
    \item
      If $X \subseteq Y \subseteq V$ then $\mc{I}(Y) \subseteq \mc{I}(X)$.
      Furthermore, $X$ is Zariski-dense in $Y$ if and only if $\mc{I}(X) = \mc{I}(Y)$.
    \item
      Let $\{X_i\}_{i \in I}$ be a collection of subsets $X_i \subseteq V$. Then
      \[
          \mc{I}\left( \bigcup_{i \in I} X_i \right)
        = \bigcap_{i \in I} \mc{I}(X_i) \,.
      \]
  \end{enumerate}
\end{lemma}


\begin{lemma}
  \label{lemma: maximal ideal correspondin to a point}
  For $a = (a_1, \dotsc, a_n) \in k^n$ the ideal $\mf{m}_a$ is maximal and given by
  \[
    \mf{m}_a = (X_1 - a_1, \dotsc, X_n - a_n) \,,
  \]
  where we identify $\mc{P}(k^n)$ with $k[X_1, \dotsc, X_n]$ as explained in~\ref{fluff: identify polynomials with polynomial maps for kn}.
\end{lemma}


\begin{proof}
  The evaluation map
  \[
            \varepsilon_a
    \colon  k[X_1, \dotsc, X_n]
    \to     k,
    \quad   f
    \mapsto f(a)
  \]
  is a surjective homomorphism of $k$-algebras with $\ker \varepsilon_a = \mf{m}_a$.
  It follows that $\mf{m}_a$ is a maximal ideal because $k[X_1, \dotsc, X_n]/\mf{m}_a \cong k$ is a field.
  
  The ideal $\mf{m} \defined (X_1 - a_1, \dotsc, X_n - a_n)$ is also maximal:
  
  We consider first the case $a_1 = \dotsb = a_n = 0$.
  Then $\mf{m} = (X_1, \dotsc, X_n)$ has a $k$-basis given by all monomials $X_1^{\alpha_1} \dotsm X_n^{\alpha_n} \neq 1$.
  It follows that the $k$-algebra $k[X_1, \dotsc, X_n]/\mf{m}$ has a basis given by the single element $\overline{1}$, and is therefore one-dimensional.
  It follows that $k[X_1, \dotsc, X_n]/\mf{m} \cong k$ as $k$-algebras.
  Then $\mf{m}$ is maximal because $k$ is a field.
  
  For general $a \in k^n$ we observe that there exists an automorphism of $k$-algebras $\Phi \colon k[X_1, \dotsc, X_n] \to k[X_1, \dotsc, X_n]$ with $\Phi(X_i) =  X_i + a_i$ for all $i = 1, \dotsc, n$.
  Then $\Phi(\mf{m}) = (X_1, \dotsc, X_n)$ is maximal as shown above so $\mf{m}$ itself is also maximal.
  
  It follows that $\mf{m}_a = \mf{m}$ because both ideals are maximal with $\mf{m} \subseteq \mf{m}_a$.
\end{proof}


\begin{corollary}
  Let $V$ be a finite-dimensional $k$-vector space and $X \subseteq V \subseteq V_L$.
  Then
  \[
      \mc{I}_k(X)_L
    = \mc{I}_L(X) \,,
  \]
  where we identify $\mc{P}(V)_L$ with $\mc{P}(V_L)$ as explained in Proposition~\ref{proposition: consistent choice of identification for polynomial functions}.
\end{corollary}


\begin{proof}
  By choosing a basis of $V$ we may identify in a consistent way
  \begin{itemize}
    \item
      the $k$-vector space $V$ with $k^n$,
    \item
      the $L$-vector space $V_L$ with $L^n$,
    \item
      the $k$-algebra $\mc{P}(V)$ with $k[X_1, \dotsc, X_n]$,
    \item
      the $L$-algebras $\mc{P}(V)_L$ and $\mc{P}(V_L)$ with $L[X_1, \dotsc, X_n]$
  \end{itemize}
  by Proposition~\ref{proposition: consistent choice of identification for polynomial functions}.
  For every point $a \in k^n$ we then have that
  \begin{align*}
        \mc{I}_k(\{a\})_L
    &=  L \otimes_k \mc{I}_k(\{a\}) \\
    &=  L \otimes_k ( X_1 - a_1, \dotsc, X_n - a_n )_{ k[X_1, \dotsc, X_n] } \\
    &=  ( X_1 - a_1, \dotsc, X_n - a_n )_{ L[X_1, \dotsc, X_n] }  \\
    &=  \mc{I}_L(\{a\}) \,.
  \end{align*}
  For every subset $X \subseteq W$ we therefore have that
  \begin{align*}
        \mc{I}_k(X)_L
    &=  L \otimes_k \mc{I}_k(X)
     =  L \otimes_k \mc{I}_k\left( \bigcup_{x \in X} \{x\} \right)
     =  L \otimes_k \left( \bigcap_{x \in X} \mc{I}_k(\{x\}) \right)  \\
    &=  \bigcap_{x \in X} \left( L \otimes_k \mc{I}_k(\{x\}) \right)
     =  \bigcap_{x \in X} \mc{I}_k(\{x\})_L
     =  \bigcap_{x \in X} \mc{I}_L(\{x\})
     =  \mc{I}_L(X) \,.
  \end{align*}
  This proves the claim.
\end{proof}


\begin{corollary}
  \label{corollary: Zariski dense scalar extension}
  Let $V$ be a finite-dimensional $k$-vector space and let
  \[
              X
    \subseteq Y
    \subseteq V
    \subseteq V_L \,.
  \]
  If $X$ is Zariski dense in $Y$ over $k$ then $X$ is also Zariski dense in $Y$ over $L$.
\end{corollary}


\begin{proof}
  We have that $\mc{I}_k(X) = \mc{I}_k(Y)$ because $X$ is Zariski dense in $Y$ over $k$.
  It follows that
  \[
      \mc{I}_L(X)
    = \mc{I}_k(X)_L
    = \mc{I}_k(Y)_L
    = \mc{I}_L(Y) \,,
  \]
  which shows that $X$ is Zariski dense in $Y$ over $L$.
\end{proof}


\begin{lemma}[Transitivity of Zariski density]
  \label{lemma: transitivity of Zariski density}
  Let $V$ be a finite-dimensional $k$-vector space and let $X \subseteq Y \subseteq Z \subseteq V$.
  If $X$ is Zariski-dense in $Y$ and $Y$ is Zariski-dense in $Z$, then $X$ is Zariski-dense in $Z$.
\end{lemma}


\begin{proof}
  It follows for every polynomial function $f \colon V \to k$ from $\restrict{f}{X} = 0$ that $\restrict{f}{Y} = 0$ and thus $\restrict{f}{Z} = 0$.
\end{proof}


\begin{fluff}
  Let $V$ be a finite-dimensional $k$-vector space.
  To prove the last part of the upcoming proposition we need to slightly generalize our notion of polynomial maps:
  
  For a subset $X \subseteq V$ a function $X \to k$ is \emph{polynomial} if it is the restriction of a polynomial function $V \to k$.
  If $X$ is Zariski dense in $Y \subseteq V$ and $f \colon Y \to k$ is a polynomial function with $\restrict{f}{X} = 0$ it then follows that $f = 0$.
  
  For a subset $X \subseteq V$ a function $f \colon X \to k$ is \emph{rational} if there exists polynomial functions $g, h \colon X \to k$ with $h(x) \neq 0$ for every $x \in X$ and
  \[
      f(x)
    = \frac{g(x)}{h(x)}
  \]
  for every $x \in X$.
  Note that a rational function $f = g/h$ vanishes if and only if its numerator $g$ vanishes.
  If $X$ is Zariski dense in $Y \subseteq V$ and $f \colon Y \to k$ is rational with $\restrict{f}{X} = 0$, it thus follows that $f = 0$.
  
  Both the polynomial functions $X \to k$ and rational functions $X \to k$ form $k$-algebras via pointwise addition and scalar multiplication of functions.
  We will come back to this generalization of polynomial functions in subsection~\ref{subsection: geometry of affine algebraic varietes}.
\end{fluff}


\begin{warning}
  While every polynomial function $f \colon X \to k$ can be extended to a polynomial function $V \to k$ the same does not hold for rational functions.
  Consider for example the subset $\GL_n(k) \subseteq \Mat_n(k)$ and the rational function $f \colon \GL_n(k) \to k$ given by
  \[
              f(A)
    \defined  \frac{1}{\det(A)} \,.
  \]
  Suppose that $f$ could be extended to a rational function $\hat{f} \colon \Mat_n(k) \to k$.
  Then the function $g \colon \Mat_n(k) \to k$ given by $g(A) = \hat{f}(A) \det(A) - 1$ is also rational and satisfies $\restrict{g}{\GL_n(k)} = 0$.
  It then follows that $g = 0$ because $\GL_n(k)$ is Zariski dense in $\Mat_n(k)$, and therefore that $\hat{f}(A) \det(A) = 1$ for all $A \in \Mat_n(k)$.
  But this is not possible.
  
  (This shows more generally that $f$ cannot be extended to a rational function $X \to k$ for any subset $X \subseteq \Mat_n(k)$ with $\GL_n(k) \subsetneq X$.)
\end{warning}


\begin{proposition}
  \leavevmode
  For the subsets $\GL_n(k), \GL_n(L), \SL_n(k), \SL_n(L)$ of $\Mat_n(L)$ we have that
  \begin{enumerate}
    \item
      \label{enumerate: GLnk Zariski dense in MnL}
      $\GL_n(k)$ is Zariski dense in $\Mat_n(L)$ over $L$,
    \item
      $\GL_n(k)$ is Zariski dense in $\GL_n(L)$ over $L$,
    \item
      $\SL_n(k)$ is Zariski dense in $\SL_n(L)$ over $L$.
  \end{enumerate}
\end{proposition}
\begin{proof}
  \leavevmode
  \begin{enumerate}
    \item
      We have already seen that $\GL_n(k)$ is Zariski dense in $\Mat_n(k)$ over $k$.
      It follows that $\GL_n(k)$ is Zariski dense in $\Mat_n(k)$ over $L$ by Corollary~\ref{corollary: Zariski dense scalar extension}, with $\Mat_n(k)$ being Zariski dense in $\Mat_n(L)$ over $L$ by Corollary~\ref{corollary: kn is Zariski dense in Ln}.
      It follows from the \hyperref[lemma: transitivity of Zariski density]{transitivity of Zariski density} that $\GL_n(k)$ is Zariski dense in $\Mat_n(L)$ over $L$.
    \item
      This follows from part~\ref*{enumerate: GLnk Zariski dense in MnL} of this proposition.
    \item
      Let $f \colon \Mat_n(L) \to L$ be a polynomial function with $\restrict{f}{\SL_n(k)} = 0$.
      Consider the map
      \[
                p
        \colon  \GL_n(L)
        \to     \SL_n(L) \,,
        \quad   A
        \mapsto \begin{bmatrix}
                  \det(A)^{-1}  &   &         &     \\
                                & 1 &         &     \\
                                &   & \ddots  &     \\
                                &   &         & 1
                \end{bmatrix}
                \cdot
                A \,,
      \]
      which divides the first row of $A$ by $\det(A)$.
      For every $A \in \SL_n(L)$ we have that $p(A) = A$, so we may think of $p$ as a (rational) retraction of $\GL_n(L)$ onto $\SL_n(L)$.
      Note that $p$ restricts to a map $\restrict{p}{\GL_n(k)} \colon \GL_n(k) \to \SL_n(k)$.
      
      The map $p$ is rational in every coordinate, so it follows that the composition $\restrict{f}{\SL_n(L)} \circ p \colon \GL_n(L) \to L$ is rational.
      For every $A \in \GL_n(k)$ we have that $p(A) \in \SL_n(k)$ and therefore
      \[
          (\restrict{f}{\SL_n(L)} \circ p)(A)
        = f(p(A))
        = 0 \,.
      \]
      It follows that $(\restrict{f}{\SL_n(L)} \circ p)(A) = 0$ for every $A \in \GL_n(L)$ because $\GL_n(k)$ is Zariski-dense in $\GL_n(L)$ over $L$.
      It then follows for every $A \in \SL_n(L)$ that
      \[
          f(A)
        = f(p(A))
        = (\restrict{f}{\SL_n(L)} \circ p)(A)
        = 0 \,.
      \]
      This shows that $\restrict{f}{\SL_n(L)} = 0$.
    \qedhere
  \end{enumerate}
\end{proof}


\begin{corollary}
  \label{corollary: extension is again invariant}
  Let $\GL_n(k), \GL_n(L), \SL_n(k), \SL_n(L)$ act on $\Mat_n(k)$, resp.\ $\Mat_n(L)$ by conjugation.
  Let $f \colon \Mat_n(k) \to k$ be a $k$-polynomial function and let $\overline{f} \colon \Mat_n(L) \to L$ be the unique $L$-polynomial extension of $f$ (as described in Proposition~\ref{proposition: consistent choice of identification for polynomial functions}).
  \begin{enumerate}
    \item
      \label{enumerate: extension is again GLn invariant}
      If $f$ is $\GL_n(k)$-invariant then $\overline{f}$ is $\GL_n(L)$-invariant.
    \item
      \label{enumerate: extension is again SLn invariant}
      If $f$ is $\SL_n(k)$-invariant then $\overline{f}$ is $\SL_n(L)$-invariant.
  \end{enumerate}
\end{corollary}


\begin{proof}
  We consider the map $\Phi \colon \Mat_n(L) \times \Mat_n(L) \to L$ given by
  \[
      \Phi(A,B)
    = \overline{f}(AB) - \overline{f}(BA)
  \]
  for all $A, B \in \Mat_n(L)$.
  We then have that
  \begin{align*}
          \text{$f$ is $\GL_n(k)$-invariant}
    &\iff \restrict{\Phi}{\GL_n(k) \times \Mat_n(k)} = 0
  \shortintertext{and similarly that}
          \text{$\overline{f}$ is $\GL_n(L)$-invariant}
    &\iff \restrict{\Phi}{\GL_n(L) \times \Mat_n(L)} = 0
  \end{align*}
  Both $\GL_n(k) \subseteq \GL_n(L)$ and $\Mat_n(k) \subseteq \Mat_n(L)$ are Zariski dense over $L$, so it follows from Lemma~\ref{lemma: product of Zariski dense is again Zariski dense} that $\GL_n(k) \times \Mat_n(k) \subseteq \GL_n(L) \times \Mat_n(L)$ is Zariski dense over $L$.
  It therefore follows that
  \[
              \restrict{\Phi}{\GL_n(k) \times \Mat_n(k)} = 0
    \implies  \restrict{\Phi}{\GL_n(L) \times \Mat_n(L)} = 0 \,.
  \]
  This shows part~\ref*{enumerate: extension is again GLn invariant}.
  
  By replacing $\GL_n$ by $\SL_n$ in the above argumentation we find that part~\ref*{enumerate: extension is again SLn invariant} holds.
\end{proof}


\begin{proposition}[Second Zariski density property]
  Let $k$ be an infinite field and let $\GL_n(k)$ act on $\Mat_n(k)$ by conjugation.
  Let $f \colon \Mat_n(k) \to k$ be a $\GL_n(k)$-invariant polynomial function and let $D \subseteq \Mat_n(k)$ be the subset of diagonal matrices.
  If $\restrict{f}{D} = 0$ then $f = 0$.
\end{proposition}
\begin{proof}
  Let $L$ be an algebraic closure of $k$ and let $\GL_n(L)$ acts on $\Mat_n(L)$ by conjugation.
  Let $\overline{f} \colon \Mat_n(L) \to L$ be the unique $L$-polynomial extension of $f$ .
  Then $\overline{f}$ is $\GL_n(L)$-invariant by Corollary~\ref{corollary: extension is again invariant}.
  
  Let $D_k \subseteq \Mat_n(k)$ and $D_L \subseteq \Mat_n(L)$ be the subsets of diagonal matrices.
  It follows from $\restrict{f}{D_k} = 0$ that $\restrict{\overline{f}}{D_k} = 0$, from which it further follows that $\restrict{\overline{f}}{D_L} = 0$ because $D_k$ is Zariski-dense in $D_L$ over $L$ by Corollary~\ref{corollary: kn is Zariski dense in Ln}.
  It follows from the \hyperref[corollary: second Zariski density property for algebraically closed fields]{second Zariski density property for algebraically closed fields} that $\overline{f} = 0$ and therefore that $f = 0$.
\end{proof}


\begin{proposition}
  Let $\GL_n(k)$ and $\SL_n(k)$ act on $\Mat_n(k)$ by conjugation.
  Then
  \[
      \mc{P}(\Mat_n(k))^{\GL_n(k)}
    = \mc{P}(\Mat_n(k))^{\SL_n(k)} \,.
  \]
\end{proposition}


\begin{proof}
  Suppose first that $k$ is algebraically closed.
  If $A, B$ are $\GL_n(k)$-conjugated then they are already $\SL_n(k)$-conjugated because for $S \in \GL_n(k)$ with $S A S^{-1} = B$ there exists some $\alpha \in k$ with $\alpha^n = 1/\det(S)$, and for $T \defined S/\alpha \in \SL_n(k)$ we then have that $T A T^{-1}$.
  It follows that the actions of $\GL_n(k)$ and $\SL_n(k)$ on $\Mat_n(k)$ have the same orbits.
  This proves the proposition for $k$ algebraically closed.
  
  Let $k$ be any infinite field.
  We need to show that every $\SL_n(k)$-invariant polynomial map $f \colon \Mat_n(k) \to k$ is already $\GL_n(k)$-invariant.
  Let $L$ be an algebraic closure of $k$ and let $\overline{f} \colon \Mat_n(L) \to L$ be the unique $L$-linear extension of $f$.
  Then $\overline{f}$ is $\SL_n(L)$-invariant by Corollary~\ref{corollary: extension is again invariant}.
  The map $\overline{f}$ is therefore already $\GL_n(L)$-invariant as shown above.
  Then $f$, which is now the restriction of $\overline{f}$ to $\Mat_n(k)$, is $\GL_n(k)$-invariant.
\end{proof}




